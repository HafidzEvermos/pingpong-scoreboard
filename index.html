<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ping Pong Counter</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    html, body {
      height: 100%;
      margin: 0;
    }
    input::placeholder {
      opacity: 0.5;
    }
  </style>
</head>
<body class="bg-gray-50">
  <div class="flex flex-col-reverse md:flex-col items-center justify-center min-h-screen w-full p-4 gap-4 overflow-hidden">
    <h1 class="text-4xl md:text-6xl font-bold">Ping Pong Scoreboard</h1>

    <!-- Controls -->
    <div class="flex flex-wrap justify-center gap-4 text-xl md:text-2xl">
      <button onclick="undo()" class="bg-yellow-100 rounded-xl px-6 py-3 shadow">â†º Undo</button>
      <button onclick="reset()" class="bg-gray-200 rounded-xl px-6 py-3 shadow">â¹ Reset</button>
      <button onclick="switchServerManually()" class="bg-green-200 rounded-xl px-6 py-3 shadow">ğŸ” Switch Server</button>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 w-full h-full max-w-7xl gap-6">
      <!-- Team A -->
      <div class="bg-red-100 p-6 rounded-2xl shadow text-center flex flex-col justify-center" id="teamA">
        <div class="flex items-center gap-4 justify-center mb-6">
          <span id="serverA1" class="text-3xl md:text-4xl hidden">ğŸ¯</span>
          <input id="nameA1" class="text-center border-b border-red-300 bg-transparent w-40 md:w-60 text-2xl md:text-4xl lg:text-5xl" value="Hafidz" />
        </div>
        <div class="flex items-center gap-4 justify-center mb-6">
          <span id="serverA2" class="text-3xl md:text-4xl hidden">ğŸ¯</span>
          <input id="nameA2" class="text-center border-b border-red-300 bg-transparent w-40 md:w-60 text-2xl md:text-4xl lg:text-5xl" value="Rizky" />
        </div>
        <div class="text-8xl md:text-9xl lg:text-[10rem] font-bold my-6" id="scoreA">0</div>
        <div class="flex justify-center gap-6 flex-wrap">
          <button onclick="updateScore('A', 1)" class="bg-white rounded-xl px-6 py-3 text-3xl md:text-4xl shadow">+</button>
          <button onclick="updateScore('A', -1)" class="bg-white rounded-xl px-6 py-3 text-3xl md:text-4xl shadow">-</button>
        </div>
      </div>

      <!-- Team B -->
      <div class="bg-blue-100 p-6 rounded-2xl shadow text-center flex flex-col justify-center" id="teamB">
        <div class="flex items-center gap-4 justify-center mb-6">
          <span id="serverB1" class="text-3xl md:text-4xl hidden">ğŸ¯</span>
          <input id="nameB1" class="text-center border-b border-blue-300 bg-transparent w-40 md:w-60 text-2xl md:text-4xl lg:text-5xl" value="Budi" />
        </div>
        <div class="flex items-center gap-4 justify-center mb-6">
          <span id="serverB2" class="text-3xl md:text-4xl hidden">ğŸ¯</span>
          <input id="nameB2" class="text-center border-b border-blue-300 bg-transparent w-40 md:w-60 text-2xl md:text-4xl lg:text-5xl" value="Yoga" />
        </div>
        <div class="text-8xl md:text-9xl lg:text-[10rem] font-bold my-6" id="scoreB">0</div>
        <div class="flex justify-center gap-6 flex-wrap">
          <button onclick="updateScore('B', 1)" class="bg-white rounded-xl px-6 py-3 text-3xl md:text-4xl shadow">+</button>
          <button onclick="updateScore('B', -1)" class="bg-white rounded-xl px-6 py-3 text-3xl md:text-4xl shadow">-</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const serverRotation = ['A1', 'B1', 'A2', 'B2'];
    let scoreA = 0;
    let scoreB = 0;
    let rotationIndex = 0;
    let history = [];

    function updateScore(team, delta) {
      history.push({ scoreA, scoreB, rotationIndex });

      if (team === 'A') {
        scoreA = Math.max(0, scoreA + delta);
      } else {
        scoreB = Math.max(0, scoreB + delta);
      }

      const newTotal = scoreA + scoreB;
      const prevTotal = history[history.length - 1].scoreA + history[history.length - 1].scoreB;

      if (Math.floor(newTotal / 2) > Math.floor(prevTotal / 2)) {
        rotationIndex = (rotationIndex + 1) % serverRotation.length;
      }

      render();
    }

    function undo() {
      const last = history.pop();
      if (last) {
        scoreA = last.scoreA;
        scoreB = last.scoreB;
        rotationIndex = last.rotationIndex;
        render();
      }
    }

    function reset() {
      scoreA = 0;
      scoreB = 0;
      rotationIndex = 0;
      history = [];
      render();
    }

    function switchServerManually() {
      rotationIndex = (rotationIndex + 1) % serverRotation.length;
      render();
    }

    function render() {
      document.getElementById('scoreA').innerText = scoreA;
      document.getElementById('scoreB').innerText = scoreB;

      ['A1', 'A2', 'B1', 'B2'].forEach(code => {
        const el = document.getElementById('server' + code);
        if (el) el.classList.add('hidden');
      });

      const serverCode = serverRotation[rotationIndex % serverRotation.length];
      const serverEl = document.getElementById('server' + serverCode);
      if (serverEl) serverEl.classList.remove('hidden');
    }

    render();
  </script>
</body>
</html>
